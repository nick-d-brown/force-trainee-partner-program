<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Force Finder | Quiz</title>
    <!-- Google Fonts CDN -->
    
    <!-- Font Awesome CDN -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.10/css/all.css" integrity="sha384-+d0P83n9kaQMCwj8F4RJB66tzIwOKmrdb46+porD/OvrJ+37WqIM7UoBtwHO6Nlg"
        crossorigin="anonymous">
    <!-- CSS External link -->
    <link rel="stylesheet" href="./assets/style.css">
    <!-- Bootstrap CDN -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4"
        crossorigin="anonymous">
    <!-- Jquery CDN -->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
        crossorigin="anonymous"></script>
    <!-- Boostrap JS -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm"
        crossorigin="anonymous"></script>
    <style>
    html, body {
        /* margin: 0; */
        /* padding: 0; */
        background: #0099F7;  /* fallback for old browsers */
        background: -webkit-linear-gradient(to right, #F11712, #0099F7);  /* Chrome 10-25, Safari 5.1-6 */
        background: linear-gradient(to right, #F11712, #0099F7); /* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */
        color: white;
    }

    .center {
        display: flex;
        justify-content: center;
    }

    /* Home Page */

        /* JumboTron */
    .jumbotron {
        margin: 2% 0;
        padding: 5px;    
    }

    .jumboInner {
        text-align: center;
        justify-content: center;
    }

        /* footer */

    .survey-footer {
        position: relative;
        bottom: 0px;
        width: 100%;
        margin: 54px 0px;
    }    

    .footer-links {
        color: white;
    }

    .copyright {
        text-align: center;
        color: white;
    }

    .link-styling {
        text-decoration: none;
        border: 1px solid white;
        padding: 4px;
        color: white;
    }

    .link-styling:hover {
        text-decoration: none;
        border: 1px solid rgb(167, 167, 167);
        padding: 4px;
        color:rgb(167, 167, 167);
        position: relative;
        top:1px;
        left: 1px;
    }

    .container-special-style {
        margin: 30px auto;
    }
    
    .modal-image {
        width: 100%;
    }

    .modal-body {
        color: black;
    }

    #modalHomeAnchor {
        color: white;
    }


    </style>
</head>
<body>
    <div class="container container-special-style">
        <form>
            <div class="user-info">
                <h1>About You</h1>
                <div class="form-group">
                    <label for="newTraineeName">Name (Required)</label>
                    <input type="text" class="form-control" id="userInputName" placeholder="ie. Darth Sidious" required>
                </div>
                <div class="form-group">
                    <label for="newTraineePicture">Link to Photo Image of you as a prospective jedi/sith apprentice (Required)</label>
                    <input type="text" class="form-control" id="userInputProfileImage" placeholder="-place link here-" required>
                </div>
                <div class="form-group">
                    <label for="newTraineeCatchphrase">What is your catchphrase?</label>
                    <input type="text" class="form-control" id="userInputCatchphrase" placeholder="i.e. I'll try to not be bad at this..." maxlength="80" required>
                </div>
            </div>
            <hr>
            <div class="quiz-questins">
                <div id="q1Container">
                    <h3>Question 1</h3>
                    <p>Pick your favorite color.</p>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q1Radios" id="q1Radios1" value="1"> Blue
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q1Radios" id="q1Radios2" value="2"> Green
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q1Radios" id="q1Radios3" value="3" checked> If this is about a lightsaber, so help me...
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q1Radios" id="q1Radios4" value="4"> Red
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q1Radios" id="q1Radios5" value="5"> Black
                        </label>
                    </div>
                </div>
                <div id="q2Container">
                    <h3>Question 2</h3>
                    <p>Which word Describes you best?</p>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q2Radios" id="q2Radios1" value="1"> Patient
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q2Radios" id="q2Radios2" value="2"> Rebelious
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q2Radios" id="q2Radios3" value="3" checked> This is stupid, I was told there would be money.
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q2Radios" id="q2Radios4" value="4"> Vengance
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q2Radios" id="q2Radios5" value="5"> Power
                        </label>
                    </div>
                </div>
                <div id="q3Container">
                    <h3>Question 3</h3>
                    <p>You're walking into the library late at night to overthrow the government and destroy the corrupt Jedi, what do you do next?</p>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q3Radios" id="q3Radios1" value="1"> Jedi I am, do I would not.
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q3Radios" id="q3Radios2" value="2"> Leave and rethink my life descisions and approach the problem with a more rational mind.
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q3Radios" id="q3Radios3" value="3" checked> Is there money involved?
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q3Radios" id="q3Radios4" value="4"> Crush them all.
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q3Radios" id="q3Radios5" value="5"> What do you think? I was the one to orchastrate the whole thing
                        </label>
                    </div>
                </div>
                <div id="q4Container">
                    <h3>Question 4</h3>
                    <p>Pick an ability.</p>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q4Radios" id="q4Radios1" value="1"> Meditation
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q4Radios" id="q4Radios2" value="2"> Force Push
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q4Radios" id="q4Radios3" value="3" checked> Good Looks
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q4Radios" id="q4Radios4" value="4"> Force Choke
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q4Radios" id="q4Radios5" value="5"> Force Lightning
                        </label>
                    </div>
                </div>
                <div id="q5Container">
                    <h3>Question 5</h3>
                    <p>What is your stance on puppies?</p>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q5Radios" id="q5Radios1" value="1"> Distraction they are.
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q5Radios" id="q5Radios2" value="2"> I think they are pretty cute.
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q5Radios" id="q5Radios3" value="3" checked> They're great until the get to be 7' 6", smelly, and compain about upgrading the hyperdrive
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q5Radios" id="q5Radios4" value="4"> I LOVE PUPPIES! (especially little ones focused on destroying my enemies)
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q5Radios" id="q5Radios5" value="5"> I have a cat.
                        </label>
                    </div>
                </div>
                <div id="q6Container">
                    <h3>Question 6</h3>
                    <p>Pick your vice.</p>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q6Radios" id="q6Radios1" value="1"> Babbling like an old man
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q6Radios" id="q6Radios2" value="2"> Avoiding chores on the farm
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q6Radios" id="q6Radios3" value="3" checked> Gambling/Shooting my Ccmpetition under the table
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q6Radios" id="q6Radios4" value="4"> Pod Racing
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q6Radios" id="q6Radios5" value="5"> Cackling Maniacly
                        </label>
                    </div>
                </div>
                <div id="q7Container">
                    <h3>Question 7</h3>
                    <p>Who was your first love?</p>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q7Radios" id="q7Radios1" value="1"> Love. Attraction. A Jedi craves not these things.
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q7Radios" id="q7Radios2" value="2"> I don't want to talk about it.
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q7Radios" id="q7Radios3" value="3" checked> Money. But then came along this princess...
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q7Radios" id="q7Radios4" value="4"> I was 9 when we met, and her name was Padme.
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q7Radios" id="q7Radios5" value="5"> The only love I feel is in the darkness of my soul.
                        </label>
                    </div>
                </div>
                <div id="q8Container">
                    <h3>Question 8</h3>
                    <p>What would you do in the case of a fire?</p>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q8Radios" id="q8Radios1" value="1"> Meditate
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q8Radios" id="q8Radios2" value="2"> Look for people to help out
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q8Radios" id="q8Radios3" value="3" checked> Run as fast as I can with perfectly quaffed hair!
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q8Radios" id="q8Radios4" value="4"> Choke the person who started the fire
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q8Radios" id="q8Radios5" value="5"> Wait for the Imperial Guard to carry my throne out
                        </label>
                    </div>
                </div>
                <div id="q9Container">
                    <h3>Question 9</h3>
                    <p>how many original fingers do you have left on both hands?</p>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q9Radios" id="q9Radios1" value="1"> All six green ones I still have.
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q9Radios" id="q9Radios2" value="2"> Technically? Five. I'm missing a hand.
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q9Radios" id="q9Radios3" value="3" checked> Ten. Is there any other answer?
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q9Radios" id="q9Radios4" value="4"> I am basically a robot. So, none.
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q9Radios" id="q9Radios5" value="5"> Do cracked curled evil hands count?
                        </label>
                    </div>
                </div>
                <div id="q10Container">
                    <h3>Question 10</h3>
                    <p>Do you require power and influence over people to feel special?</p>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q10Radios" id="q10Radios1" value="1"> 1 (Strongly disagree, I'm an old crazy dude.)
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q10Radios" id="q10Radios2" value="2"> 2
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q10Radios" id="q10Radios3" value="3" checked> 3
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q10Radios" id="q10Radios4" value="4"> 4
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="q10Radios" id="q10Radios5" value="5"> 5 (Strongly agree, because of the Unlimited Power.)
                        </label>
                    </div>
                </div>
            </div>
        </form>
        <hr>
        <div class="submit">
            <button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal" id="add-btn">Submit</button>
        </div>

    </div>
                <footer class="survey-footer center">
                    <div>
                        <p class="footer-links">
                            <a href="/api/user_list" class="link-styling">API Friends List</a>
                            <a href="/" class="link-styling">Home Page</a>
                            <a href="https://github.com/nick-d-brown/force-trainee-partner-program" class="link-styling">GitHub Repo</a>
                        </p>
                        <p class="copyright">&copy; 2018 Nick Brown</p>
                    </div>
                </footer>
        <!-- ============Modal================ -->
    
    <!-- Modal -->
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <h3>Your Mentor</h3>
                    <div id="modalMentorData"></div>
                    <hr>
                    <h3>Your fellow Mentee</h3>
                    <div id="modalMenteeData"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal" id="modalClose">Close</button>
                    <button type="button" class="btn btn-primary" id="modalToHome"><a href="/" id="modalHomeAnchor">Home</a></button>
                </div>
            </div>
        </div>
    </div>


<!-- =============JS LOGIC=============== -->
<script type="text/javascript">

    // create newTrainee object submit survey button
    $("#add-btn").on("click", function (event) {
        var inputName = $("#userInputName").val().trim();
        var inputImage = $("#userInputProfileImage").val();
        var inputcatchPhrase = $("#userInputCatchphrase").val().trim();
        var q1 = parseInt($('input[name=q1Radios]:checked').val());
        var q2 = parseInt($('input[name=q2Radios]:checked').val());
        var q3 = parseInt($('input[name=q3Radios]:checked').val());
        var q4 = parseInt($('input[name=q4Radios]:checked').val());
        var q5 = parseInt($('input[name=q5Radios]:checked').val());
        var q6 = parseInt($('input[name=q6Radios]:checked').val());
        var q7 = parseInt($('input[name=q7Radios]:checked').val());
        var q8 = parseInt($('input[name=q8Radios]:checked').val());
        var q9 = parseInt($('input[name=q9Radios]:checked').val());
        var q9 = parseInt($('input[name=q9Radios]:checked').val());
        var q10 = parseInt($('input[name=q10Radios]:checked').val());
        
        console.log(q1);
        

        event.preventDefault();
        var newTrainee = {
            name: inputName,
            picture: inputImage,
            listOfScores: [q1, q2, q3, q4, q5, q6, q7, q8, q9, q10], //list of their score
            totalScore:  0,
            catchPhrase: inputcatchPhrase
        };
        console.log(newTrainee.listOfScores);
        
        
        newTrainee.totalScore = scoreAdd(newTrainee.listOfScores, newTrainee.totalScore, newTrainee);
        console.log(newTrainee);
        
        
        
        // posts this new reservation to postman
        $.post("/api/user_list", newTrainee,
            function (data) {
                console.log(data); //true
            });
            //=======================================================
        // After the users data is posted make ajax call to receive all data back
           runUserQuery();
    });
  
    // clear the divs with charater match and inputs
    $("#modalClose").on("click", function () {
        $("#userInputName").val("");
        $("#userInputProfileImage").val("");
        $("#userInputCatchphrase").val("");
        $("#modalMentorData").empty();
        $("#modalMenteeData").empty();

    });

    $('#myModal').on('hidden.bs.modal', function () {
        $("#userInputName").val("");
        $("#userInputProfileImage").val("");
        $("#userInputCatchphrase").val("");
        $("#modalMentorData").empty();
        $("#modalMenteeData").empty();
    });


//global use functions
    function scoreAdd(arr, dest, variab) {
        console.log(arr + ' ad ' + dest);
        for (let i = 0; i < arr.length; i++) {
            dest+=arr[i];
        }
        return dest;
        console.log(dest);
        console.log(variab);
        
        
    }


   function runUserQuery(){
       var currentURL = window.location.origin;

        $.ajax({ url: currentURL + "/api/user_list", method: "GET" })
           .then(function (userData) {
                console.log(userData);
                var enteredData = userData.trainees[userData.trainees.length-1]; // gets data of trainee just added
                console.log(parseInt(enteredData.totalScore));
                var userMentor = userData.mentors[findMentor(parseInt(enteredData.totalScore))];
                console.log(userMentor);
                var userPairedMentee = userData.trainees[findFellowMentee(userData.trainees, parseInt(enteredData.totalScore))];
                console.log(findFellowMentee(userData.trainees, parseInt(enteredData.totalScore)));
                
                console.log(userPairedMentee);
                
                
                // append data and manipulate dom
                $("#modalMentorData").append("<h4>" + userMentor.name + "</h4>"
                                              + "<h6>" + userMentor.catchPhrases[Math.floor(Math.random()*userMentor.catchPhrases.length)] + "</h6>"
                                              + "<img src='" + userMentor.picture + "' class='modal-image'>");
                $("#modalMenteeData").append("<h4>" + userPairedMentee.name + "</h4>"
                                              + "<h6>" + userPairedMentee.catchPhrase + "</h6>"
                                              + "<img src='" + userPairedMentee.picture + "' class='modal-image'>");

           });
   }

   function findMentor(userScoreTotal){
     
    if (userScoreTotal <= 10){
          // return yoda
          console.log("yoda");
          return 0
          
      } else if (userScoreTotal > 10 && userScoreTotal <= 25) {
          console.log("luke");
          return 1
          
      } else if (userScoreTotal > 25 && userScoreTotal < 40) {
          console.log("han");
          return 2
          
      } else if (userScoreTotal >= 40 && userScoreTotal < 50) {
          console.log("vader");
          return 3
          
      } else {
          console.log("emp");
          return 4
          
          
      }
   }

   function findFellowMentee(mentteArr, userScoreTotal){
       // check if user score is equal to or within 9
    //    console.log(mentteArr.length);
    //    console.log(userScoreTotal);
    //    console.log(mentteArr[2].totalScore);
    
       
       for (i = mentteArr.length-2; i>=0; i--) {
        //    console.log(mentteArr[i]);
           
           if (userScoreTotal === parseInt(mentteArr[i].totalScore)) {
        //    if (userScoreTotal === parseInt(parseInt(mentteArr[i].totalScore))) {
               // use this person
               console.log("1 logged "+i);
               
               return i;
           } 
        }
       for (i = (mentteArr.length-2); i>=0; i--) {
           if ((((userScoreTotal - parseInt(mentteArr[i].totalScore)) >= (-2) ) && ((userScoreTotal - parseInt(mentteArr[i].totalScore)) <= 0))|| (((userScoreTotal - parseInt(mentteArr[i].totalScore)) <= 2)) && ((userScoreTotal - parseInt(mentteArr[i].totalScore)) >= 0)) {
                console.log(userScoreTotal - parseInt(mentteArr[i].totalScore));
                   
            // use this person
               console.log("2 logged "+i);
               
               return i;
           } 
        }
       for (i = (mentteArr.length-2); i>=0; i--) {
           if ((((userScoreTotal - parseInt(mentteArr[i].totalScore)) >= (-5) ) && ((userScoreTotal - parseInt(mentteArr[i].totalScore)) <= 0))|| (((userScoreTotal - parseInt(mentteArr[i].totalScore)) <= 5)) && ((userScoreTotal - parseInt(mentteArr[i].totalScore)) >= 0)) {
                console.log(userScoreTotal - parseInt(mentteArr[i].totalScore));
                   
            // use this person
               console.log("3 logged "+i);
               
               return i;
           } 
        }
       for (i = (mentteArr.length-2); i>=0; i--) {
           if ((((userScoreTotal - parseInt(mentteArr[i].totalScore)) >= (-10) ) && ((userScoreTotal - parseInt(mentteArr[i].totalScore)) <= 0))|| (((userScoreTotal - parseInt(mentteArr[i].totalScore)) <= 10)) && ((userScoreTotal - parseInt(mentteArr[i].totalScore)) >= 0)) {
                console.log(userScoreTotal - parseInt(mentteArr[i].totalScore));
                   
            // use this person
               console.log("4 logged "+i);
               
               return i;
           } 
        }
           
           
           
       }

</script>

       
  
</body>
</html>


            